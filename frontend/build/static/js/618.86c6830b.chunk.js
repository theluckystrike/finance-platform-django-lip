"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[618],{4618:(e,a,s)=>{s.r(a),s.d(a,{default:()=>b});var l=s(5043),r=s(3892),t=s(899),n=s(5061),i=s(3576),o=s(3216),d=s(3219),c=s(5893),m=s(2879),u=s(3585),p=s(4193),h=s(579);const x=e=>{let{show:a,handleClose:s,categoryFilter:n}=e;const[x,{isLoading:j,isSuccess:v,isError:g,error:N,data:b}]=(0,c.HE)(),[f,y]=(0,u.fk)();console.log(n);const I=(0,o.Zp)(),[w,A]=(0,l.useState)(""),k=(0,p.A)(),F=(0,r.Wx)({initialValues:{name:"",parent:"",parentName:""},validationSchema:t.Ik({name:t.Yj().required("Category name is required")}),onSubmit:e=>{x({token:m.V.access,data:e}),s()}});return(0,l.useEffect)((()=>{if(v&&k.SuccessToast("New Category added successfully"),g)if(null!==N&&void 0!==N&&N.data){k.ErrorToast("Token is invalid or expired. Please login again."),I("/login"),localStorage.removeItem("login");const e=N.data;console.log("Error:",e.detail||"An unknown error occurred")}else console.log("An unknown error occurred.")}),[v,g,N,b]),(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(i.A,{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,show:a,onHide:s,children:(0,h.jsx)(i.A.Body,{className:"bg-light-green",style:{borderRadius:"25px",overflow:"hidden"},children:(0,h.jsx)("form",{onSubmit:F.handleSubmit,encType:"multipart/form-data",children:(0,h.jsx)("div",{className:"mb-3",children:(0,h.jsxs)("div",{className:"row mx-0 px-3",children:[(0,h.jsxs)("div",{className:"col-12 m-0",children:[(0,h.jsx)("label",{htmlFor:"category",className:"form-label",children:"Category Name"}),(0,h.jsx)("input",{id:"name",name:"name",className:"form-control m-0",required:!0,value:F.values.name,onChange:F.handleChange,onBlur:F.handleBlur}),F.touched.name&&F.errors.name?(0,h.jsx)("div",{className:"text-danger",children:F.errors.name}):null]}),(0,h.jsxs)("div",{className:"col-12",children:[(0,h.jsx)("label",{htmlFor:"parent",className:"form-label",children:"Parent Category"}),(0,h.jsxs)("div",{className:"dropdown",children:[(0,h.jsx)("input",{type:"text",placeholder:"All",value:F.values.parentName,readOnly:!0}),(0,h.jsx)("div",{className:"dropdown-content",style:{height:"200px",overflow:"auto"},children:n.length>0&&n.map(((e,a)=>{var s;return(0,h.jsxs)("span",{className:"h6  ",children:[(0,h.jsx)("span",{className:"hover-span ",onClick:()=>{F.setFieldValue("parent",e.id),F.setFieldValue("parentName",e.name)},children:e.name}),null===(s=e.subcategories)||void 0===s?void 0:s.map(((e,a)=>{var s;return(0,h.jsxs)("span",{className:"text-muted hover-span",children:[(0,h.jsx)("span",{className:"hover-span  text-muted",onClick:()=>{F.setFieldValue("parent",e.id),F.setFieldValue("parentName",e.name)},children:e.name}),null===(s=e.subcategories)||void 0===s?void 0:s.map(((e,a)=>(0,h.jsx)("span",{className:"fs-6 ",children:(0,h.jsx)("span",{className:"hover-span  text-mute",onClick:()=>{F.setFieldValue("parent",e.id),F.setFieldValue("parentName",e.name)},children:e.name})},a)))]},a)}))]},e.name)}))})]})]}),(0,h.jsxs)("div",{className:"col-12 row justify-content-evenly m-0",children:[(0,h.jsx)("label",{style:{height:"33px"},htmlFor:"category",className:"invisible",children:"Last Updated"}),(0,h.jsx)("button",{onClick:()=>I(`/account/${d.on.CategoryManager.path}`),className:"btn border border-dark col-5 px-3 fw-bold",type:"button",children:"Edit All Category"}),(0,h.jsx)("button",{className:"btn btn-dark col-5 px-3 fw-bold",type:"submit",children:"Apply"})]})]})})})})})})};var j=s(8672),v=s(3003),g=s(388);const N=t.Ik({category:t.Yj().required("Category is required"),output_type:t.Yj().required("Output type is required"),name:t.Yj().required("Script name is required"),file:t.gl().required("File is required")}),b=()=>{const e=(0,v.wA)(),[a,s]=(0,l.useState)(null),t=(0,l.useRef)(null);(0,l.useEffect)((()=>{const e=localStorage.getItem("login");e&&s(JSON.parse(e))}),[]);const{data:i,isError:o}=(0,c.HP)({token:null===a||void 0===a?void 0:a.access,page_no:1,page_size:1e3}),d=(null===i||void 0===i?void 0:i.categories)||[],m=(0,p.A)(),[b,f]=(0,l.useState)([]),{data:y,error:I,isLoading:w}=(0,u.DD)({token:null===a||void 0===a?void 0:a.access,page_no:1,page_size:1e3}),[A,k]=(0,l.useState)(!1),[F,C]=(0,l.useState)(""),V=(0,r.Wx)({initialValues:{category:"",output_type:"",name:"",file:null,description:"sadasd",parentName:""},validationSchema:N,onSubmit:async(s,l)=>{let{resetForm:r}=l;const n=new FormData;n.append("category",s.category),n.append("output_type","plt"),n.append("name",s.name),n.append("file",s.file),n.append("description",s.description),await e((0,g.Zj)({formData:n,token:null===a||void 0===a?void 0:a.access})),r(),t.current.value="",m.SuccessToast("New Script added successfully")}});return(0,l.useEffect)((()=>{const e={};d.forEach((a=>{e[a.id]={...a,subcategories:[]}})),d.forEach((a=>{if(null!==a.parent.parent_name){const s=Object.values(e).find((e=>e.name===a.parent.parent_name));s&&s.subcategories.push(e[a.id])}}));const a=Object.values(e).filter((e=>null===e.parent.parent_name));f(a)}),[d]),(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"UploadScript_main_wrap mt-3",children:[(0,h.jsx)("h1",{className:"h1 fw-bold",children:"Upload a Script"}),(0,h.jsxs)("div",{className:"d-flex justify-content-center",children:[(0,h.jsxs)("form",{className:"w-75",style:{maxWidth:"600px"},onSubmit:V.handleSubmit,encType:"multipart/form-data",children:[(0,h.jsxs)("div",{className:"mb-3",children:[(0,h.jsx)("label",{htmlFor:"category",className:"form-label",children:"Category"}),(0,h.jsxs)("div",{className:"row mx-0 p-0",children:[(0,h.jsx)("div",{className:"col-11 m-0 p-0 pe-1",children:(0,h.jsxs)("div",{className:"dropdown",children:[(0,h.jsx)("div",{className:"arrow_down",children:(0,h.jsx)("img",{src:j,alt:""})}),(0,h.jsx)("input",{type:"text",placeholder:"All",value:V.values.parentName,readOnly:!0,className:"form-control "+(V.touched.category&&V.errors.category?"input-error":"")}),(0,h.jsx)("div",{className:"dropdown-content",style:{height:"200px",overflow:"auto"},children:b.length>0&&b.map(((e,a)=>{var s;return(0,h.jsxs)("span",{className:"h6",onClick:()=>{V.setFieldValue("parentName",e.name),V.setFieldValue("category",e.id)},children:[e.name,null===(s=e.subcategories)||void 0===s?void 0:s.map(((e,a)=>{var s;return(0,h.jsxs)("span",{className:"text-muted",onClick:()=>{V.setFieldValue("parentName",e.name),V.setFieldValue("category",e.id)},children:[e.name,null===(s=e.subcategories)||void 0===s?void 0:s.map(((e,a)=>(0,h.jsx)("span",{className:"fs-6 hover-span",onClick:()=>{V.setFieldValue("parentName",e.name),V.setFieldValue("category",e.id)},children:e.name},a)))]},a)}))]},e.name)}))})]})}),(0,h.jsx)("button",{className:"btn btn-dark col col-1 p-0 justify-content-center",type:"button",onClick:()=>k(!0),children:(0,h.jsx)(n.A,{icon:"Add",size:"30px"})}),V.touched.category&&V.errors.category?(0,h.jsx)("div",{className:"error-message",children:V.errors.category}):null]})]}),(0,h.jsxs)("div",{className:"mb-3",children:[(0,h.jsx)("label",{htmlFor:"output_type",className:"form-label",children:"How would you like to view data?"}),(0,h.jsxs)("div",{className:"dropdown",children:[(0,h.jsx)("div",{className:"arrow_down",children:(0,h.jsx)("img",{src:j,alt:""})}),(0,h.jsx)("input",{type:"text",id:"output_type",placeholder:"All",className:"form-control "+(V.touched.output_type&&V.errors.output_type?"input-error":""),...V.getFieldProps("output_type")}),(0,h.jsxs)("div",{className:"dropdown-content",children:[(0,h.jsx)("span",{className:"hover-span",onClick:()=>V.setFieldValue("output_type","pd"),children:"Chart"}),(0,h.jsx)("span",{className:"hover-span",onClick:()=>V.setFieldValue("output_type","plt"),children:"Table"}),(0,h.jsx)("span",{className:"hover-span",onClick:()=>V.setFieldValue("output_type","pd plt"),children:"Chart and Table"})]}),V.touched.output_type&&V.errors.output_type?(0,h.jsx)("div",{className:"error-message",children:V.errors.output_type}):null]})]}),(0,h.jsxs)("div",{className:"mb-3",children:[(0,h.jsx)("label",{htmlFor:"name",className:"form-label",children:"Script name"}),(0,h.jsx)("input",{type:"text",id:"name",className:"form-control "+(V.touched.name&&V.errors.name?"input-error":""),...V.getFieldProps("name")}),V.touched.name&&V.errors.name?(0,h.jsx)("div",{className:"error-message",children:V.errors.name}):null]}),(0,h.jsxs)("div",{className:"mb-3",children:[(0,h.jsx)("label",{htmlFor:"file",className:"form-label",children:"Select a file"}),(0,h.jsx)("input",{type:"file",id:"file",name:"file",ref:t,className:"form-control "+(V.touched.file&&V.errors.file?"input-error":""),onChange:e=>V.setFieldValue("file",e.target.files[0])}),V.touched.file&&V.errors.file?(0,h.jsx)("div",{className:"error-message",children:V.errors.file}):null]}),(0,h.jsxs)("div",{className:"mx-auto text-center d-flex justify-content-between",children:[(0,h.jsx)("button",{type:"submit",className:"btn btn-dark px-5",children:"Upload"}),(0,h.jsx)("button",{type:"reset",className:"btn btn-light bordered-button px-5",onClick:()=>V.resetForm(),children:"Reset"})]})]}),(0,h.jsx)(x,{show:A,handleClose:()=>k(!1),categoryFilter:b})]})]})})}},8672:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAaVBMVEX///8AAADm5ubz8/MkJCQwMDD19fXw8PBXV1dQUFBZWVlTU1MuLi4pKSlYWFgmJiZeXl5mZmbExMRLS0vd3d2Dg4MfHx+tra2YmJjQ0NDh4eEODg6MjIxvb2/r6+toaGgYGBhDQ0M6OjoUjT9JAAAEKUlEQVR4nO3c6VbqMBQFYApaJgcUUVQcru//kBdvjCXNTihthhPu/n63y5yVM6QFHI2IiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIqHj3m9l6tX3IvYwTPWxX69nmvsOVL6vqn9ddHX1VAe1e1bJXR3fm4brSbiYplhbG2++qX5/9V74/Vo35NM3yBqs/Dlb9+O69dlMdmheSqHfGqje+S6efxrXVrIhE/TAX/elLvfuqZSk/UeuP9qJ9DfWpfbH8EOs7a81PnsvtCKul8ES1A/RG+GxfXs1EtxsrRfd886K+BTcIHhogRavqwrslW3CH3ESFAVZb/z1/0D1ChwYOcH2kqsbX6C6RIeIAr/xHmr3xJUxUebWIA7wcH79zjLpNtZTWUesVWuZthwD3IV6gexeyQsQ7eNEpQFeiiqpFvINdUlQRH+LQAF2JKuZ0gwPsmqIKbjdCahHXYLcm0xCcqMNTVHGM/vy7iAO8PjlAsYk6ZA62ja9giHkTFQd41StAkbUYqgY1cUOjXqAFnTYmTDjEVa4QQ8zBNlGJOoE72D9FFdxubnLsIk7Rvk2mIWZohBwTJjz6k9diuEFvw7WYeC5OZmgRQ2tQw7uYtBZrGGCYHfyGazFhouImE6IGNccBLlWIkxv054d30UOOWkwTYtwa1DK+nsI1OOwkg2Q7wIU/i7rgRI3+dYbpMkWKKlnazQQGGLbJNDIMDdxkQo4JU/IDHA4w3KC3JT7ApaxBDSdqpKf+yTxtiioJhwZO0RhjwpQsUadwB+OmqJJoLuYLMNEBDs/B+CmqJJiLqedgW/Q3cDlTVIn8sQ0eEzEHvS3qG7jcKapE/NgGn2RiHbbdotVi/hrUIn1sg2sw1ZgwRZmLuY5qWIRElZOiCm43A0LEAaZvMo3AiZr3qIbh0d8zRBxg2kFvC1iL0mpQw7vY48uaEo5qWKADnIyjGhako0o5qmEBalFqDWqDD3CSjmrYwLko66iGDfqGv/QUVXC76fRrG3lHNaz323B8kpExJkw9f22Dx4SEQW/rVYtl1KDW49c2eT586Q8PDc9Xi0oYEyZHR3Ulaild9NBJtVhWDWo4UWEtSnyi78IxF+2hIflxyQ8nqvVz6TJTVMHtZm7uIh4TsptMo0OilnNUw44+9ct+ou/iyNAouQY1nKg/tVjaUQ1zvNj4DrG8oxrmHBrnkKKK44z6UnyTaeBEhQVaXooquN2gqAsN0FWLlhJrUMPvblpkvpPpqkOilpuiCu6oB8rsooeO1GLJNajhofGj1DFh8oR4HgF6EvUcUlRxtJvym0wDDo3Sx4QJjP6yB73NqsXzqUGttYvntoPfjKFxLmPCNP76DfDrLAMcjab6f1K/yfsfhaE87xbrxe7If9wmIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiov/cX08aJw5PInkjAAAAAElFTkSuQmCC"}}]);
//# sourceMappingURL=618.86c6830b.chunk.js.map